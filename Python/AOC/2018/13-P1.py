Input = ["""                                         /----------------------------------------------------------------------------------------------------------L 
                                         |                                                 /---------------------L           /-----------------L    | 
          /-------------------------L    |                                        /--------+-----------L         |           | /----------L    |    | 
          |              /----------+----+----------------------------------------+--------+-----------+-------L |           | |          |    |    | 
          | /------------+L         |    |              /-------------------------+--------+-L         |       | |           | |          |    |    | 
          | |            ||         |    |         /----+-------------------------+--------+-+---------+-------+-+-L         | |          |    |    | 
          | |         /--++--------L|   /+---------+----+-------------------------+--------+L|         |    /--+-+-+---------+-+----------+-L  |    | 
          | |         |  ||      /-++---++---------+----+-------------------------+--------+++---------+----+--+-+-+---------+-+----L     | |  |    | 
          | |         |  ||/-----+-++---++---------+----+--L   /------------------+--------+++---------+----+--+-+-+---------+-+----+-----+-+--+L   | 
/---------+-+---------+--+++-----+-++---++---------+----+--+---+-L                |        |||         |    |  | | |         | |    |     | |  ||   | 
|         | |         |  |||     | ||   ||         |    |  |   | |  /---------L   |        |||         |    |  | | |         | |    |     | |  ||   | 
|         | |         |  |||    /+-++---++---------+----+--+---+-+--+---------+---+--------+++---------+----+--+-+L|         | |    |     | |  ||   | 
|         | |         |  |||    || ||   ||         |   /+--+---+-+--+---------+---+--------+++------L  |    |  | |||         | L----+-----/ |  ||   | 
|      /--+-+---------+--+++----++-++---++---------+---++--+---+-+--+-------L |   |        |||      |  |    |  | |||         |      |       |  ||   | 
|  /---+--+-+---------+--+++----++-++---++->L      |   ||  |   | |  |       | |   |        |||      |  |    |  | |||         |      |       |  ||   | 
|  |   |  | |         |  |||    || ||   ||  |  /---+---++--+---+-+--+-------+-+---+--------+++------+--+----+--+-+++---------+----L |       |  ||   | 
|  |   |  | |         |  |||    || ||   ||  |  v   |/--++--+-L | |  |       | |   |        |||  /---+--+----+--+-+++--------L|    | |       |  ||   | 
|  |   |  | |         |/-+++----++-++---++--+--+---++--++--+-+-+-+--+-------+L|   |        |||  |   |  | /--+--+-+++--------++----+-+-------+--++--L| 
|  |   |  | |     /---++-+++----++-++---++--+--+---++--++--+-+-+-+--+--L    |||   |        |||  |   |  | |  |  | |||        ||    | |       |  ||  || 
|  |   |  | |     |   || |||    || ||   ||  |  |   ||  ||  | | | |  |  |    |||   |        |||  | /-+--+-+--+--+-+++--------++----+-+---L   |  ||  || 
|  |   |  | |     |   || |||    || ||   ||  |  |   ||  ||/-+-+-+-+--+--+----+++---+--------+++--+-+-+--+-+--+--+-+++--------++-L  | |   |   |  ||  || 
|  |   |  | |  /--+---++-+++----++-++---++--+--+---++--+++-+-+-+-+L |  | /--+++---+--------+++--+-+-+>-+-+--+--+-+++--------++-+--+-+---+---+--++L || 
|  |   |  | |  | /+---++-+++----++L||   L+--+--+---++--+++-+-+-+-++-+--+-+--+++---+--------+/|  | | |  | |  |/-+-+++--------++-+--+-+---+-L |  ||| || 
|  |   |  | |  | ||   || |||    |||||    |  |  |   ||  ||| | | | || |  | |  |||   | /------+-+--+-+-+--+-+--++-+-+++--------++-+L | |   | | |  ||| || 
|  |   |  | |  | ||   L+-+++----+++/|    L--+--+---++--+++-+-+-+-++-+--+-+--+++---+-+------+-+--+-+-+--+-+--++-+-+++--------++-++-+-+-<-+-+-+--+++-+/ 
|  L---+--+-+--+-++----+-+++----+++-+-------/  |  /++--+++-+-+-+-++-+--+L|  |||   | |      L-+--+-+-+--+-+--++-+-/||        || || | |   | | |  ||| |  
|      |  | |  | ||    | |||    ||| |          |  |||  ||| | | | || |  |||  |||   | |        | /+-+-+--+-+--++-+--++--------++-++-+-+--L| | |  ||| |  
|      |  | |  | ||    | |||    ||| |          |  |||  ||| | | | || |  |||  |||   | |        | || | |  | |  || |  ||        || || | |  || | |  ||| |  
|      |  | |  | ||    | |||    ||| |          |  |||  ||| | | | || |  |||  |||   | |  /-----+-++-+-+--+-+--++-+--++------L || || | |  || | |  ||| |  
|      |  | |  |/++----+-+++----+++-+----------+--+++--+++-+-+-+-++-+--+++--+++---+-+--+-----+-++-+-+--+-+--++-+-L||      | || || | |  || | |  ||| |  
|      |/-+-+--++++----+-+++----+++-+----------+--+++--+++-+-+-+L|| |  |||  |||   | |  |     | ||/+-+--+-+--++-+-+++-----L| || ||/+-+--++-+-+--+++L|  
|/-----++-+-+--++++----+-+++----+++-+----------+--+++L ||| | | |||| |  |||  |||   | |  | /---+-++++-+--+-+--++-+-+++-----++-++-++++-+--++-+-+--+++++L 
||     || | |  ||||/---+-+++----+++-+----------+L |||| ||| | | |||| |  |||  |||   L-+--+-+---+-++++-+--/ |  || | |||     || || |||| |  || | |  |||||| 
||     || | |  |||||   | |||    |||/+----------++-++++-+++-+-+-++++-+--+++--+++-----+--+-+---+-++++-+----+--++-+-+++-----++-++-++++-+--++-+L|  |||||| 
||     || | |  |||||   | |||    |||||          || ^||| ||| | | |||| |  |||  |||     |  | |   | |||| |    |  || | |||     || || |||| |  || |||  |||||| 
||     || | |  |||||   | |||   /+++++----------++-++++-+++-+-+-++++-+--+++--+++-----+--+-+---+-++++-+----+--++-+-+++-----++-++-++++L|  || |||  |||||| 
||     || | |/-+++++---+-+++-L ||||||          || |||| ||| | | |||| |  |||  |||     |  | |   | |||| |    |  || | |||     || || ||||||  || |||  |||||| 
||     || | || |||||   | ||| | ||||||          ||/++++-+++-+-+-++++-+-L|||  |||     |  | |  /+-++++-+----+--++-+-+++-----++L|| ||||||  || |||  |||||| 
||     || | || |||||   | ||| | ||||||    /-----+++++++-+++-+-+-++++-+-++++--+++-----+--+-+--++-++++-+----+--++-+-+++-----+++++-++++++--++-+++L |||||| 
||     || | || |||||   | ||| | ||||||    |     ||||||| ||| | | |||| | ||||  |||     |  | |  || |||| |    |  || | |||     ||||| ||||||  || |||| |||||v 
||     || | || |||||   | ||| | ||||||   /+-----+++++++-+++-+-+-++++-+-++++--+++-----+--+-+--++-++++-+----+--++L| |||     ||||| ||||||  || |||| |||||| 
||     || | || |||||   | ||| | ||||||   ||     ||||||| ||| | | |||| | ||||  |||     |  | L--++-++++-+----+--++++-+++-----+++++-++++++--++-++++-+++++/ 
||     || | || |||||   | ||| | ||||||   ||     ||||||| |||/+-+-++++-+-++++--+++----L|  |    || |||| |    |  |||| |||     ||||| ||||||  || |||| |||||  
||     || | || |||||   | ||| | ||||||   ||     ||||||| L++++-+-++++-+-++++--+++----++--+----++-++++-/    |  |||| |||     ||||| ||||||  || |||| |||||  
||     || L-++-+++++---+-+++-+-+++++/   ||    /+++++++--++++-+-++++-+-++++--+++----++--+----++-++++------+--++++-+++-----+++++-++++++--++L|||| |||||  
||     ||   || |||||   | |||/+-+++++----++----++++++++--++++-+-++++-+-++++--+++--L ||  |/---++-++++------+--++++-+++-----+++++-++++++-L||||||| |||||  
||     ||   || |||||   | ||L++-+++++----++----++++++++--+++/ | |||| |/++++--+++--+-++L || /-++-++++------+--++++-+++----L||||| |||||| |||||||| |||||  
||     ||   || |||||   | || || |||||    ||    ||||||||  |||  | |||| ||||||  |||  | ||| || | || ||||      |  |||| |||    |||||L-++++++-++++++++-/||||  
||  /--++---++-+++++---+-++-++-+++++--L ||    ||||||||  ||| /+-++++-++++++--+++--+-+++-++-+-++-++++------+--++++-+++----+++++L |||||| ||||||||  ||||  
||  |  ||   ||/+++++---+-++-++-+++++--+-++----++++++++--+++-++-++++-++++++--+++--+-+++-++-+-++L||||      |  |||| |||    |||||| |||||| ||||||||  ||||  
||  |  ||   ||||||||   | || || |||||  | ||    ||||||||  ||| || |||| ||||||  |||  | ||| || | |||||L+------+--++++-+++----+/|||| |||||| ||||||||  ||||  
||  |  ||   ||||||||   |/++-++-+++++--+-++----++++++++--+++-++-++++-++++++--+++--+L||| || | ||||| |      |  |||| |||    | |||| |||||| ||||||||  ||||  
||  |  ||   ||||||||   |||| || |||||  | ||   /++++++++--+++-++-++++-++++++--+++--+++++-++-+-+++++-+--L   |  |||| |||    | |||| |||||| ||||||||  ||||  
||  |  ||   ||||||||   ||^| || |||||  | || /-+++++++++--+++-++-++++-++++++--+++--+++++-++-+-+++++-+--+---+--++++-+++---L| |||| |||||| ||||||||  ||||  
||  |  ||   ||||||||   |||| || |||||  | || | |||||||||  ||| || |||| ||||||  |||  ||||| || | ||||| |  |   |  |||| |||   || |||| |||||| ||||||||  ||||  
||  | /++---++++++++---++++-++-+++++--+-++-+-+++++++++--+++-++-++++-++++++--+++-L||||| || | ||||| |  |   |  |||| |||   || |||| |||||| ||||||||  ||||  
||  | |||   |L++++++---++++-+/ |||||  | || | |||||||||  ||| || |||| ||||||  ||| |||||| ||/+-+++++-+--+---+--++++-+++---++L|||| |||||| ||||||||  ||||  
|| /+-+++---+-++++++---++++-+--+++++--+-++-+-+++++++++--+++-++-++++-++++++--+++-++++++-++++-+++++-+--+---+L |||| |||   ||||||| |||||| ||||||||  ||||  
|| || |||/--+-++++++---++++-+--+++++--+-++-+-+++++++++--+++-++-++++-++++++--+++-++++++-++++L||||| |  |   || |||| |||   ||||||| |||||| ||||||||  ||||  
|| || ||||  | ||||||   |||| |  |||||  | || | |||||||||  ||| || |||| ||||||  ||| |||||| |||||||||| |  |   L+-++++-+++---+++++++-++++++-++++++++--+++/  
|| || ||||  | ||||||   |||| |  |||||  | || | |||||||||  ||| || |||| ||||||  ||| |||||| |||||||||| |  |    | |||| |||   ||||||| |||||| ||||||||  |||   
|| || ||||  | ||||||   |||| |  |||||  | || | |||||||||  L++-++-++++-++++++--+++-++++++-++++++/||| |  |    | |||| |||   |||||||/++++++-++++++++--+++-L 
|| || ||||  | ||||||   |||| |  |||||  | |L-+-+++++++++---++-++-++++-++++++--+++-++++++-++++++-+++-+--+----+-++++-+++->-++++++++++++++-+++++++/  ||| | 
|| || ||||  | |||||L---++++-+--+++++--+-+--+-+++/|||||   || ||/++++-++++++-L||| |||||| |||||| ||| |  |    | |||| |||   |||||||||||||| |||||||   ||| | 
|| || ||||  | |||||/---++++-+--+++++--+-+-L| ||L-+++++---++-+++++++-++++++-++++-++++++-++++++-+++-+--+----+-++++-+++---+++++++++++/|| |||||||   ||| | 
|| || |L++--+-++++++---++++-+--+++++--+-+-++-++--+++++---++-+++++++<++++++-+/|| |||||| L+++++-+++-+--+----+-++++-+++---+++/||||||L-++-+++++++---++/ | 
|| || | ||  | ||||||   |||| |  |||||  | | || ||  |||||   || ||||||| |L++++-+-++-+++++/  ||||| ||| |  |    | |||| |||   ||| ||||||  || |||||||   ||  | 
|| || | ||  | ||||||  /++++-+--+++++--+-+-++-++L |||||   || ||||||| |/++++-+-++-+++++---+++++-+++-+--+----+-++++-+++---+++-++++++L || |||||||   ||  | 
|| ||/+-++--+-++++++--+++++-+--+++++--+-+-++-+++-+++++---++-+++++++-++++++L| || |||||   ||||| ||| |  |    | |||| |||   ||| ||||||| || |||||||   ||  | 
|| |||| ||  | ||||||  ||||| |  |||||  | | || ||| |||||   || ||||||| |||||L++-++-+++++---+++++-+++-+--+----+-++++-+++---+++-+++++++-++-+++++++---+/  | 
|| |||| ||  | ||||||  ||||| |  |||||  |/+-++-+++-+++++---++L||||||| ||||| || || |||||   ||||| ||| |  |    | |||| |||   ||| ||||||| || |||||||   |   | 
|| |||| ||  | |||||| /+++++-+--+++++--+++-++-+++-+++++---++++++++++-+++++-++-++-+++++---+++++-+++-+--+L   | |||| |||   ||| ||||||| || |||||||   |   | 
|| |||| ||  ^ |||||| |||||| |  |||||  ||| || ||| ||||| /-++++++++++-+++++-++-++-+++++---+++++-+++-+--++L/-+-++++-+++---+++-+++++++-++-+++++++--L|   | 
|| |||| ||  | L+++++-++++++-+--+++++--+++-++-+++-+++++-+-++++++++++-+++++-++-++-+++++---+++++-/||/+--++++-+-++++-+++-L ||| ||||||| || |||||||  ||   | 
|| |||| ||  |  L++++-++++++-+--+++++--+++-++-+++-+++++-+-+++++++++/ ||||| || || |||||   |||||  ||||  |||| | |||| ||| | ||| ||||||| || |||||||  ||   | 
|| |||| ||  |   |||| |||||| |  |||||  ||| |L-+++-+++++-+-+++++++++--+++++-++-++-+++++---+++++--++++--++++-+-++++-+++-+-/|| ||||||| || |||||||  ||   | 
|| |||| ||  |   |||| |||||| |  |||||  |||/+--+++-+++++-+-+++++++++--+++++-++-++-+++++---+++++--++++--++++-+-++++-+++-+--++-+++++++-++-+++++++L ||   | 
|| |||| ||  |   |||| |||||| |  |||||  |||||  ||| ||||| | |||||||||  ||||| || || |||||   |||||  ||||  |||| | |||| ||| |  || ||||||| || |||||||| ||   | 
|| |||| || /+---++++-++++++-+--+++++--+++++L ||| ||||| | |||||||||  ||||| || || |||||   |||||  ||||  |||| | |||| ||| |  || ||||||| || |||||||| ||   | 
|| |||| || ||   |||| |||||| |  |L+++--++++++-+++-+++++-+-+++++++++--+++++-++-++-+++++---+++++--++++--++++-+-++++-+/| |  || ||||||| || |||||||| ||   | 
|| |||| L+-++---++++-++++++-+--+-+++--++++++-+++-+++++-+-+++++++/|  ||||| || || |||||   |||||  ||||  |||| | |||| | | |  || ||||||| || |||||||| ||   | 
|| ||||  | ||   |||| |||||| |  L-+++--++++++-+++-+++++-+-+++++++-+--+++++-++-++-+++++---+++++--++++--++++-+-++++-+-+-+--++-+++++++-/| |||||||| ||   | 
|| ||||  | ||   |||| |||||| |    |||  |||||| ||| ||||| | ||||||| |  ||||| || || ||||L---+++++--++++--++++-+-++++-+-+-+--++-+++++/|  | |||||||| ||   | 
|| |||| /+-++---++++-++++++-+----+++--++++++L||| ||||| | ||||||| |  ||||| || || ||||    |||||  ||||  |||| | L+++-+-+-+--++-+++++-+--+-++++++/| ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| ||||| | ||||||| |  ||||| || || ||||    |||||  ||||  |||| |  ||| | | |  || ||||| |  | |||||| | ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| ||||| | ||||||| |  ||||| || || ||||    |||||  ||||  |||| |  ||| | | |  || ||||| |  | |||||| | ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| ||||| | ||||||| |  ||||| || || ||||    ||||L--++++--++++-+--+++-+-+-+--++-/|||| |  | |||||| | ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| ||||| | ||||||| |  ||||| || || ||||    ||||   ||||  |||| |  ||| | | |  ||  |||| |  | |||||| | ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| ||||| | ||||||| |  ||||| || || ||||    ||||   |L++--++++-+--+++-+-+-+--++--/||| |  | |||||| | ||   | 
|| |||| || ||   |||| |||||| |    |||  |||||||||| |L+++-+-+++++++-+--++++/ || || ||||  /-++++---+-++--++++-+--+++-+-+-+--++---+++-+--+-++++++-+-++--L| 
|| |||| || ||   |||| |||||| |    |||  |||||||||| | ||| | ||||||| |  ||||  || || ||||  | ||||   | ||  |||| |  ||| | | |  ||   ||| |  | |||||| | ||  || 
|| |||| || ||   |||| |||||| |    |||  |||||||||| | ||| | ||||||| | /++++--++-++-++++--+-++++---+-++--++++-+--+++-+-+-+--++---+++-+--+-++++++-+L||  || 
|| ||||/++-++---++++-++++++-+---LL++--++++++++++-+-+++-+-+++++++-+-+++++--++-++-++++--+-++++---+-++--++++-+--+++-+-+-+--++---+++-+--/ |||||| ||||  || 
|| ||||||| ||   |||| |||||| |   | ||  |||||||||| | ||| | ||||||L-+-+++++--++-++-++++--+-++++---+-++--++++-+--+++-+-+-+--++---+++-+----++++++-+++/  || 
|| ||||||| ||   |||| L+++++-+---+-++--++++++++++-+-+++-+-++++++--+-+++++--++-++-++++--+-++++---+-++--+/|| |  ||| | | |  ||   ||| |    |||||| |||   || 
|| ||||||| ||   ||||  ||||| |   | ||  |||||||||| | ||| | ||||||  | |||||  || || ||||  | ||||   | |^  | || |  ||| | | |  ||   |L+-+----++++++-+++---+/ 
|| |||L+++-++---++++--+++++-+---+-++--++++++++++-+-+++-+-++++++--+-+++++--++-++-/|||  | ||||   | ||  | || |  ||| | | |  ||   | | |    |||||| |||   |  
|| ||| ||| ||   ||||  ||||| |   | ||  |L++++++++-+-+++-+-++/|||  | |||||  || ||  |||  | ||||   | ||  | || |  ||| | | |  ||   | v |    |||||| |||   |  
|| ||| ||| ||   ||||  |||L+-+---+-++--+-++++++++-+-+++-+-++-+++--+-+++++--++-++--+++--+-++++---+-++--+-++-+--++/ | | |  ||   | | |    |||||| |||   |  
|| ||| ||| ||   ||||  ||| | |   | ||  | |||||||| | ||| | || |||  | |L+++--++-+/  |||  | ||||   | ||  |/++-+--++--+-+-+--++---+-+-+-L  |||||| |||   |  
|| ||| ||| ||   ||||  ||| | |   | ||  | |||||||| | ||| | || ||L--+-+-+++--+/ |   |||  | ||||   | ||  |||| |  ||  | | |/-++---+-+-+-+--++++++-+++-L |  
|| ||| |||/++---++++--+++-+L|   | ||  | |||||||| | ||| | L+-++---+-+-+++--+--+---+++--+-++++---+-++--++++-+--++--+-+-++-++---+-//+-+--++++++-+++-+L|  
|| ||| ||||||   ||||  ||| |||   | ||  | |||||||| | ||| |  | ||   | | |||  |  |   |||  | ||||   | ||  |||| |  ||  | | || ||   |  || |  |||||| ||| |||  
L+-+++-++++++---++++--+++-+++---+-++--+-++++++++-+-+++-+--+-++---/ | |||  |  |   |||  | ||||   | ||  |||| |  ||/-+-+-++-++---+L || |  |||||| ||| |||  
 | |L+-++++++---++++--+++-+++---+-++--/ ||||||L+-+-+++-+--+-++-----+-+++--+--+---+++--+-++++---+-++--++++-+--+++-+-+-++-++---++-++-+--+++/|| ||| |||  
 | | | |||||L---++++--+++-/||   | ||    |||||| | | ||| |  | ||     | |||  |  |   |||  | |||| /-+-++--++++-+--+++-+-+-++-++---++-++-+--+++-++L||| |||  
 | | | |||||   /++++--+++--++---+-++----++++++-+-+LL++-+--+-++-----+-+++--+--+---+++--+-++++-+-+-++--++++-+--+++-+-/ || ||   || || |  ||| |||||| |||  
 | | | |||||   |||L+--+++--++---+-++----++++++-+-++-++-+--+-++-----+-++/  |  |   |||/-+-++++-+-+-++--++++L|  ||| |   || ||   || || |  ||| |||||| |||  
 | | | |||||   ^|| |  ||L--++---+-++----++++++-+-++-++-+--+-++-----+-++---+--+---+/|| | |||| | L-++--++++++--+++-+---++-++---++-++-+--+/| |||||| |||  
 | | | ||||L---+++-+--++---++---+-++----+++/|| | || || |  |/++-----+-++---+--+---+-++-+L|||| |   ||  ||||||  ||| |   || ||   || || |  | | |||||| |||  
 | | | ||||    ||| |  ||   ||   | ||    L++-++-+-++-++-+--++++-----+-++---+--+---+-++-++++++-+---++--++++++--+/| |   || ||   || L+-+--+-+-++++++-+/|  
 | | | ||||    ||| |  ||   ||   | ||     || || | || || |  L+++-----+-++---+--+---+-/| |||||| |   ||  ||||||  | | |   || ||   ||  | |  | | |||||| | |  
 | | | ||||    ||| |  |L---++---+-++-----++-++-+-++-++-+---+++-----+-++---+--/   |  | |||||| |   ||  ||||||  | | |   || ||   ||  | |  | | |||||| | |  
 | | | |L++----+++-+--+----++---+-++-----++-/| | || L+>+---++/     L-++---+------+--+-++++++-+---++--++++++--+-+-+---++-++---++--+-+--+-+-++++/| | |  
 | | | | ||    ||L-+--+----++---+-/|     ||  | | ||  | |   ||        ||   |      |  | |||||| |   ||  ||||||  | | |   || ||   ||  | |  | | |||| | | |  
 | | | | ||  /-++--+--+----++---+--+-----++--+-+-++--+L|   ||        ||   |      |  | |||||| |   ||  ||||||  | | |   || ||  /++--+-+--+-+-++++-+-+L|  
 | | | | ||  | ||  |/-+----++---+--+-----++--+-+-++--+++---++--------++---+------+--+-++++++-+--L||  ||||||  | | |   || ||  |||  | |  | | |||| | |||  
 | | | | ||  | ||  || |    ||   |  |     ||  | ^ ||  |||   ||        ||   |      |  | |||||| |  |||  ||||||  | | |   || ||  |||  | |  | | |||| | |||  
 | | | | ||  | ||  || |    ||   |  |     ||  | | ||  |||   ||        ||   |      |  | |||||| |  ||L--++++++--+-+-+---++-++--+++--+-+--+-/ |||| | |||  
 | | | | ||  | L+--++-+----++---+--+-----++--+-+-+/  |||   || /------++---+------+--+-++++++-+--++<--++++++--+-+-+---++-++--+++--+-+--+---++++-+-+++-L
 | | | | ||  |  |  || |    ||   |  |     ||  | | |   |||   || |      ||   |      |  | |||L++-+--++---++++++--+-+-+---++-+/  |||  | |  |   |||| | ||| |
 L-+-+-+-++--+--+--++-+----++---+--+-----++--+-+-+---/||   || |      ||   |      |  | ||| || |  ||   ||||||  | | |   |L-+---+++--+-+--+---++++-+-/|| |
   | | | ||  |  |  || |    ||   |  |     ||  | | L----++---++-+------+/   |      |  | ||| || |  ||   |L++++--+-+-+---+--+---+++--+-/  |   |||| |  || |
   | | | ||  |  |  || |    ||   |  |     ||  | |      ||   || |      |    |      |  | ||| || |  ||   | ||||  L-+-+---+--+---+++--+----+---/||| |  || |
   | L-+-++--+--+--++-+----++---+--+-----++--+-+------++---++-+------+----/      |  | ||| || |  |L---+-++++----+-+---/  |   |||  |    |    ||| |  || |
   |   | ||  |  |  || |    ||   |  |     ||  | |      ||   || |      |           |  | ||| || |  |   /+-++++----+-+------+---+++--+----+---L||| |  || |
   |   | ||  |  |  || |    ||   |  |     ||  | |      ||   || |      |           |  | ||| || |  |   || |L++----+-+------+---+++--+----+---++++-/  || |
   |   | ||  |  |  || |    ||   |  L-----++--+-+------++---++-+------+-----------+--+-+++-++-+--+---++-+-++----+-+------+---+++--+----+---+/||    || |
   |   | ||  |  |  || |    ||   |        ||  | |      |L---++-+------+-----------+--+-+++-++-+--+---++-/ ||    | |      |   |||  |    |   | ||    || |
   |   | ||  |  |  || |    ||   |        ||  L-+------+----++-+------+-----------+--+-+++-++-+--+---+/   ||    L-+------+---++/  |    |   | ||    || |
   |   | ||  |  |  || |    ||   |        ||    |      |    |L-+------+-----------+--+-+++-++-+--+---+----++------+------+---+/   |    |   | ||    || |
   |   | ||  |  |  || |    ||   |        ||    |      |    |  |      |           |  L-+++-++-+--+---+----/|      |      |   |    |    |   | ||    || |
   |   | ||  |  |  || L----++---+--------++----/      |    |  |      |           |   /+++-++-+--+---+-----+------+------+---+L   |    |   | ||    || |
   |   | ||  |  |  L+------++---+--------+/     /-----+----+--+------+-----------+--L|L++-++-+--+---+-----+------+------+---++---+----+---+-++----+/ |
   |   | |L--+--+---+------/|   |        L------+-----+----+--+------+-----------+--++-++-++-+--+---+-----+------+------+---++---+----+---+-+/    |  |
   |   | |   |  L---+-------+---+--->-----------+-----+----+--+------+-----------+--++-++-++-+--+---+-----+------/      |   L+---+----+---+-+-----/  |
   |   | |   |      |       |   |               |     |    |  |      |           |  || || || |  |   |     |             |    |   |    |   | |        |
   |   | |   |      L-------+---+---------------+-----+----+--+------+-----------+--++-++-++-+--/   |     |             |    |   |    |   | |        |
   |   | |   L--------------+---+---------------+-----/    |  |      |           |  || || || L------+-----+-------------+----+---+----+---+-/        |
   |   | |                  |   |               |          L--+------+-----------+--++-/| ||        |     |             |    |   |    |   |          |
   |   | |                  |   |               |             |      |           |  ||  | L+--------+-----+-------------/    |   |    |   |          |
   |   | |                  |   |               |             |      |           |  ||  |  |        |     |                  |   |    |   |          |
   L---+-+------------------+---+---------------+-------------+------+-----------+--++--+--+--------+-----/                  |   |    |   |          |
       | L------------------+---+---------------+-------------+------+-----------+--++--+--/        |                        |   |    |   |          |
       |                    |   |               L-------------+------+-----------+--/|  L-----------+------------------------+---+----/   |          |
       |                    |   |                             |      L-----------+---+--------------+------------------------+---/        |          |
       |                    L---+-----------------------------+------------------/   L--------------+------------------------/            |          |
       L------------------------/                             |                                     |                                     |          |
                                                              |                                     L-------------------------------------/          |
                                                              L--------------------------------------------------------------------------------------/"""]

# Input = ["""/->-L        
# |   |  /----L
# | /-+--+-L  |
# | | |  | v  |
# L-+-/  L-+--/
#   L------/   """]

Map = Input[0].split("\n")

Width = len(Map[0])
Height = len(Map)

Carts = []
for Row in range(Height):
  for Column in range(Width):
    if Map[Row][Column] in [">", "<"]:
      if Map[Row][Column] == "<":
        Carts.append((Row, Column, "Left", "Left"))
      if Map[Row][Column] == ">":
        Carts.append((Row, Column, "Right", "Left"))
      Map[Row] = Map[Row][:Column] + "-" + Map[Row][Column + 1:]
    if Map[Row][Column] in ["^", "v"]:
      if Map[Row][Column] == "^":
        Carts.append((Row, Column, "Up", "Left"))
      if Map[Row][Column] == "v":
        Carts.append((Row, Column, "Down", "Left"))
      Map[Row] = Map[Row][:Column] + "|" + Map[Row][Column + 1:]

print(Carts)

def Update(TUple):
  CRow = TUple[0]
  CColumn = TUple[1]
  CDirection = TUple[2]
  Turn = TUple[3]
  if CDirection == "Down":
    CRow += 1
  elif CDirection == "Right":
    CColumn += 1
  elif CDirection == "Up":
    CRow -= 1
  elif CDirection == "Left":
    CColumn -= 1
    
  Tile = Map[CRow][CColumn]
  if Tile == "L":
    if CDirection == "Up":
      CDirection = "Left"
      return((CRow, CColumn, CDirection, Turn))
    if CDirection == "Left":
      CDirection = "Up"
      return((CRow, CColumn, CDirection, Turn))
    if CDirection == "Down":
      CDirection = "Right"
      return((CRow, CColumn, CDirection, Turn))
    if CDirection == "Right":
      CDirection = "Down"
      return((CRow, CColumn, CDirection, Turn))
  if Tile == "/":
    if CDirection == "Up":
      CDirection = "Right"
      return((CRow, CColumn, CDirection, Turn))
    if CDirection == "Left":
      CDirection = "Down"
      return((CRow, CColumn, CDirection, Turn))
    if CDirection == "Down":
      CDirection = "Left"
      return((CRow, CColumn, CDirection, Turn))
    if CDirection == "Right":
      CDirection = "Up"
      return((CRow, CColumn, CDirection, Turn))
  #FIXME
  #Add turning on + tile
  if Tile == "+":
    if Turn == "Left":
      CDirection = ["Up", "Down", "Left", "Right"][["Right", "Left", "Up", "Down"].index(CDirection)]
      return((CRow, CColumn, CDirection, "Straight"))
    if Turn == "Straight":
      return((CRow, CColumn, CDirection, "Right"))
    if Turn == "Right":
      CDirection = ["Right", "Left", "Up", "Down"][["Up", "Down", "Left", "Right"].index(CDirection)]
      return((CRow, CColumn, CDirection, "Left"))
  return((CRow, CColumn, CDirection, Turn))

def SortFunc(Tuple):
  return(Tuple[0] * 10000 + Tuple[1])

def FindCrash(AllCarts):
  List = []
  for x in AllCarts:
    List.append((x[0], x[1]))
  if len(List) == len(set(List)):
    return(False)
  return(True)

while True:
  Breakout = False
  for Index in range(len(Carts)):
    Carts[Index] = Update(Carts[Index])
    if FindCrash(Carts):
      Breakout = True
      break
  if Breakout:
    break
  Carts.sort(key=SortFunc)


print(Carts)

List = []
for x in Carts:
  List.append((x[1], x[0])) #REVERSED FOR OUTPUT!!!!

for x in List:
  if List.count(x) == 2:
    print(x)
    break